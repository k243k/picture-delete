# GalleryCleaner - 画像自動整理ツール

毎朝9:00に「ピクチャ」フォルダの画像ファイルを自動でゴミ箱へ移動するツールです。

## 特徴
- ✅ **管理者権限不要** - 通常ユーザーでインストール可能
- ✅ **安全設計** - ゴミ箱へ移動（完全削除しない）
- ✅ **簡単インストール** - 次へボタンを押すだけ
- ✅ **OneDrive対応** - リダイレクトされたフォルダも自動認識

## インストール手順

### (1) ダウンロード
`GalleryCleanerSetup.exe` をダウンロードします。

### (2) セットアップ起動
ダウンロードした `GalleryCleanerSetup.exe` をダブルクリックします。
「WindowsによってPCが保護されました」と表示された場合：
1. 「詳細情報」をクリック
2. 「実行」をクリック

### (3) インストール画面
1. 言語選択: 「日本語」を選択 → 「OK」
2. セットアップウィザード: 「次へ」をクリック
3. インストール先: そのまま「次へ」をクリック
4. インストール準備: 「インストール」をクリック

### (4) インストール完了
1. 「今すぐテスト実行（ドライラン）」のチェックを入れる（推奨）
2. 「完了」をクリック

### (5) 動作確認
テスト実行を選択した場合、実際には削除せずに対象ファイルの一覧が表示されます。
正常に動作することを確認してください。

## 使い方

### 自動実行
インストール後は何もする必要はありません。
毎朝9:00に自動で実行されます。

### 手動実行（テスト）
```powershell
# ドライラン（削除せず確認のみ）
powershell -ExecutionPolicy Bypass -File "%LOCALAPPDATA%\GalleryCleaner\clean.ps1" -WhatIf

# 実際に実行
powershell -ExecutionPolicy Bypass -File "%LOCALAPPDATA%\GalleryCleaner\clean.ps1"
```

### 対象ファイル
- 拡張子: `.jpg`, `.jpeg`, `.png`, `.gif`, `.heic`, `.bmp`
- 場所: ピクチャフォルダ（サブフォルダ含む）

### ログ確認
処理結果は以下の場所に保存されます：
```
%LOCALAPPDATA%\GalleryCleaner\logs\YYYY-MM-DD.log
```

## アンインストール

### 方法1: コントロールパネル
1. 「設定」→「アプリ」→「アプリと機能」
2. 「GalleryCleaner」を検索
3. 「アンインストール」をクリック

### 方法2: 手動削除
```bat
%LOCALAPPDATA%\GalleryCleaner\uninstall.bat
```

## トラブルシューティング

### 実行ポリシーエラーが出る場合
1. PowerShellスクリプト（clean.ps1）を右クリック
2. 「プロパティ」を選択
3. 「全般」タブの下部「セキュリティ」欄
4. 「ブロックの解除」にチェック → 「OK」

### 企業のウイルス対策ソフトでブロックされる場合
IT管理者に以下のフォルダを例外登録してもらってください：
```
%LOCALAPPDATA%\GalleryCleaner
```

### OneDriveの「ファイル オンデマンド」使用時
オフラインファイル（クラウドのみ）は処理できません。
対象ファイルを事前にダウンロードしてください。

### タスクが実行されない場合
以下を確認してください：
- **PCがスリープ中**: スリープ解除時刻を8:50頃に設定
- **ユーザー未ログオン**: ログオン状態で9:00を迎える必要があります
- **時刻がずれている**: Windowsの時刻設定を確認
- **タスクが無効化**: タスクスケジューラで「GalleryCleaner9AM」を確認

### タスクの状態確認
```bat
schtasks /Query /TN "GalleryCleaner9AM"
```

### サポートに連絡する場合
以下の情報を提供してください：
1. ログファイル: `%LOCALAPPDATA%\GalleryCleaner\logs\`
2. Windowsバージョン: `winver` コマンドで確認
3. エラーメッセージのスクリーンショット

## 注意事項
- ゴミ箱の容量を超える場合は、古いファイルから完全削除されます
- ゴミ箱から復元可能な期間はWindows設定に依存します（通常30日）
- 処理中のファイル（開いている画像など）はスキップされます

## ライセンス
このツールはフリーソフトウェアです。